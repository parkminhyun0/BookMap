<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>📘 도서 상세 페이지</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <div id="loading" class="alert alert-info">⏳ 도서 정보를 불러오는 중입니다...</div>
    <div id="book-detail"></div>
    <a href="book.html" class="btn btn-link mt-4">📚 도서 목록으로</a>
  </div>

  <script>
  const API_URL = "https://script.google.com/macros/s/AKfycbxFb7I_eFXm7nPtkcezalzNRSeJ3Pg5lPM6byRbiEHkF8pXVjReRC_kYKsVD0flABYrQw/exec";

  // URL에서 id 파라미터 가져오기
  const urlParams = new URLSearchParams(window.location.search);
  const bookId = parseInt(urlParams.get("id"), 10);

  async function loadBookDetail() {
    try {
      const res = await fetch(API_URL + "?status=승인");
      const books = await res.json();

      document.getElementById("loading").style.display = "none";

      if (!books || isNaN(bookId) || !books[bookId]) {
        document.getElementById("book-detail").innerHTML = `<div class="alert alert-danger">❌ 도서를 찾을 수 없습니다.</div>`;
        return;
      }

      const b = books[bookId];

      document.getElementById("book-detail").innerHTML = `
        <div class="card shadow-sm">
          <div class="row g-0">
            <div class="col-md-4">
              <img src="${b.cover || 'https://via.placeholder.com/200x300'}" class="img-fluid rounded-start" alt="${b.title}">
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h3 class="card-title mb-3">${b.title}</h3>
                <p><b>저자:</b> ${b.author || '-'}</p>
                <p><b>옮긴이:</b> ${b.translator || '-'}</p>
                <p><b>출판사:</b> ${b.publisher || '-'}</p>
                <p><b>분류:</b> <span class="badge bg-primary">${b.category || '-'}</span></p>
                <p><b>난이도:</b> <span class="badge bg-success">${b.level || '-'}</span></p>
                <p class="mt-3">${b.reason || '설명 없음'}</p>
                ${b.link ? `<a href="${b.link}" target="_blank" class="btn btn-outline-secondary mt-2">🔗 구매/참고 페이지</a>` : ''}
              </div>
            </div>
          </div>
        </div>
      `;
    } catch (err) {
      document.getElementById("loading").textContent = "❌ 불러오기 실패: " + err;
    }
  }

  loadBookDetail();
  </script>
</body>
</html>
