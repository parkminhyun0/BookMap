<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“˜ ë„ì„œ ìƒì„¸ í˜ì´ì§€</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <div id="loading" class="alert alert-info">â³ ë„ì„œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
    <div id="book-detail"></div>
    <a href="book.html" class="btn btn-link mt-4">ğŸ“š ë„ì„œ ëª©ë¡ìœ¼ë¡œ</a>
  </div>

  <script>
  const API_URL = "https://script.google.com/macros/s/AKfycbxFb7I_eFXm7nPtkcezalzNRSeJ3Pg5lPM6byRbiEHkF8pXVjReRC_kYKsVD0flABYrQw/exec";

  // URLì—ì„œ id íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°
  const urlParams = new URLSearchParams(window.location.search);
  const bookId = parseInt(urlParams.get("id"), 10);

  async function loadBookDetail() {
    try {
      const res = await fetch(API_URL + "?status=ìŠ¹ì¸");
      const books = await res.json();

      document.getElementById("loading").style.display = "none";

      if (!books || isNaN(bookId) || !books[bookId]) {
        document.getElementById("book-detail").innerHTML = `<div class="alert alert-danger">âŒ ë„ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>`;
        return;
      }

      const b = books[bookId];

      document.getElementById("book-detail").innerHTML = `
        <div class="card shadow-sm">
          <div class="row g-0">
            <div class="col-md-4">
              <img src="${b.cover || 'https://via.placeholder.com/200x300'}" class="img-fluid rounded-start" alt="${b.title}">
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h3 class="card-title mb-3">${b.title}</h3>
                <p><b>ì €ì:</b> ${b.author || '-'}</p>
                <p><b>ì˜®ê¸´ì´:</b> ${b.translator || '-'}</p>
                <p><b>ì¶œíŒì‚¬:</b> ${b.publisher || '-'}</p>
                <p><b>ë¶„ë¥˜:</b> <span class="badge bg-primary">${b.category || '-'}</span></p>
                <p><b>ë‚œì´ë„:</b> <span class="badge bg-success">${b.level || '-'}</span></p>
                <p class="mt-3">${b.reason || 'ì„¤ëª… ì—†ìŒ'}</p>
                ${b.link ? `<a href="${b.link}" target="_blank" class="btn btn-outline-secondary mt-2">ğŸ”— êµ¬ë§¤/ì°¸ê³  í˜ì´ì§€</a>` : ''}
              </div>
            </div>
          </div>
        </div>
      `;
    } catch (err) {
      document.getElementById("loading").textContent = "âŒ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: " + err;
    }
  }

  loadBookDetail();
  </script>
</body>
</html>
